!function(a,b){"use strict";if(a&&a.customize){var c=a.customize;c.SFGuidedTourSteps=[],"undefined"!=typeof _wpCustomizeSFGuidedTourSteps&&b.extend(c.SFGuidedTourSteps,_wpCustomizeSFGuidedTourSteps),c.SFGuidedTour={$container:null,currentStep:-1,init:function(){this._setupUI()},_setupUI:function(){var a=this,c=b("body.wp-customizer .wp-full-overlay");this.$container=b("<div/>").addClass("sf-guided-tour"),c.prepend(this.$container),this._addListeners(),this.$container.css(b("body").hasClass("rtl")?"right":"left",b("#customize-controls").width()+10+"px").on("transitionend",function(){a.$container.addClass("sf-loaded")}),this._showNextStep(),b(document).on("click",".sf-guided-tour-step .sf-nux-button",function(){return a._showNextStep(),!1}),b(document).on("click",".sf-guided-tour-step .sf-guided-tour-skip",function(){return 0===a.currentStep?a._hideTour(!0):a._showNextStep(),!1})},_addListeners:function(){var a=this;c.state("expandedSection").bind(function(){a._adjustPosition()}),c.state("expandedPanel").bind(function(){a._adjustPosition()})},_adjustPosition:function(){var a=this._getCurrentStep(),d=c.state("expandedSection").get(),e=c.state("expandedPanel").get();if(a)if(this.$container.removeClass("sf-inside-section"),d&&a.section===d.id)this._moveContainer(b(d.container[1]).find(".customize-section-title")),this.$container.addClass("sf-inside-section");else if(!1===d&&!1===e)if(this._isTourHidden())this._revealTour();else{var f=this._getSelector(a.section);this._moveContainer(f)}else this._hideTour()},_hideTour:function(a){var c=this;this._isTourHidden()||(this.$container.css({transform:"",top:this.$container.offset().top}),b("body").addClass("sf-exiting").on("animationend.storefront webkitAnimationEnd.storefront",function(){b(this).removeClass("sf-exiting").off("animationend.storefront webkitAnimationEnd.storefront").addClass("sf-hidden"),c.$container.hide(),_.isUndefined(a)||!0!==a||c._removeTour()}))},_revealTour:function(){var a=this;b("body").removeClass("sf-hidden"),a.$container.show(),b("body").addClass("sf-entering").on("animationend.storefront webkitAnimationEnd.storefront",function(){b(this).removeClass("sf-entering").off("animationend.storefront webkitAnimationEnd.storefront"),a.$container.css({top:"auto",transform:"translateY("+parseInt(a.$container.offset().top,10)+"px)"})})},_removeTour:function(){this.$container.remove()},_closeAllSections:function(){c.section.each(function(a){a.collapse({duration:0})}),c.panel.each(function(a){a.collapse({duration:0})})},_showNextStep:function(){var b,c;if(this._isLastStep())return void this._hideTour(!0);this._closeAllSections(),b=this._getNextStep(),b.message=this._lineBreaksToParagraphs(b.message),c=a.template("sf-guided-tour-step"),this.$container.removeClass("sf-first-step"),0===this.currentStep&&(b.first_step=!0,this.$container.addClass("sf-first-step")),this._isLastStep()&&(b.last_step=!0,this.$container.addClass("sf-last-step")),this._moveContainer(this._getSelector(b.section)),this.$container.html(c(b))},_moveContainer:function(a){var b,c=this;a&&(b=parseInt(a.offset().top,10)+a.height()/2-44,this.$container.addClass("sf-moving").css({transform:"translateY("+parseInt(b,10)+"px)"}).on("transitionend.storefront",function(){c.$container.removeClass("sf-moving"),c.$container.off("transitionend.storefront")}))},_getSelector:function(a){var d=c.section(a)?c.section(a):c.panel(a);return b(_.isUndefined(d)?a:d.container[0])},_getCurrentStep:function(){return c.SFGuidedTourSteps[this.currentStep]},_getNextStep:function(){return this.currentStep=this.currentStep+1,c.SFGuidedTourSteps[this.currentStep]},_isTourHidden:function(){return!!b("body").hasClass("sf-hidden")},_isLastStep:function(){return!(this.currentStep+1<c.SFGuidedTourSteps.length)},_lineBreaksToParagraphs:function(a){return"<p>"+a.replace("\n\n","</p><p>")+"</p>"}},b(document).ready(function(){c.SFGuidedTour.init()})}}(window.wp,jQuery);